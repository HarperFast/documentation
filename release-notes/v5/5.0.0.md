---
title: 5.0.0
---

# 5.0.0

## RocksDB

Harper 5.0 now uses RocksDB as its default underlying storage engine. RocksDB provides a significantly more robust and reliable
storage engine with consistent performance characteristics. RocksDB is well-maintained, has powerful background compaction
capabilities, and a wide array of tuning options and features.

Harper also introduces its own native transaction log as a write-ahead log (WAL) for RocksDB, which drives ACID compliance
in RocksDB, as well as powers real-time delivery of data. This is a highly optimized transaction log designed for high throughput
of messaging and data. This is all powered by our new [open source rocksdb-js library](https://github.com/harperfast/rocksdb-js).

RocksDB will enable robust transactions in Harper, with the complete ability to read and query after writes (and get data from those writes) within a transaction.

Harper will continue to support the existing LMDB storage engine for v5.0, and will continue to load databases created with LMDB.

Switching a database from LMDB to RocksDB requires a database migration. This can be done using replication by creating
new nodes and replicating the data from the old nodes to the new nodes.

### Current Limitations of RocksDB

Currently, there are a number of optimizations with querying, caching, contention monitoring, and write batching that
have not yet been implemented in v5.0, but are planned for a future release. LMDB exhibits better performance for data
that is cached in-memory.
Retrieval of past events is not guaranteed to return every event when concurrent events take place on different nodes. This is often used by non-clean MQTT sessions. However, the latest message is always guaranteed to be delivered, sequences of messages from the same node are guaranteed to be delivered in order, ensuring the correctness of most applications and message retain consistency.
Retrieval of past events for subscriptions will not support a `count` option.

## Resource API Updates

Harper v5.0 has upgraded the resource API with several important changes:

- Harper v5.0 is specifically encouraging the use of static REST methods, and providing functionality to easily use these methods.
- The `target` (`RequestTarget` type) will now be parsed prior to calling static REST methods, for access to any query information in the URL.
- The current request (`Request` type) will be available in any function through asynchronous context tracking, using the `getContext()` function available from the `harper` module.
- The `get` method will always return a frozen enumber record.

## Application Context Separation

Harper now runs each application its own separate JavaScript "context", which has its own global object, top level variables, and module imports. This provides isolation of applications and access to application-specific configuration data and functionality. These contexts will limit access to certain node modules like `fs` and `child_process`. This functionality can be controlled with configuration options.

## Open Source and Pro Editions

Harper v5.0 is available in two editions: Open Source and Pro. The Open Source edition is free and open source under the Apache 2.0 license, while the Pro edition includes replication, certificate management, and licensing functionality (the source code is available under the Elastic 2.0 License).
The open source edition can be installed with:
`npm i -g harper`
And the pro edition can be installed with:
`npm i -g @harperfast/harper-pro`
